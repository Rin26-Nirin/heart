<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡πÄ‡∏Å‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏ú‡∏•‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏ï‡∏µ</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #ffe8f0; padding: 2rem; }
    .character { font-size: 3rem; }
    #log { margin-top: 1rem; color: #444; }
    button { padding: 10px 20px; font-size: 1.2rem; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üí• ‡πÄ‡∏Å‡∏°‡∏ú‡∏•‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏ï‡∏µ! üí•</h1>

  <p>‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: <strong id="playerRole">‡∏£‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</strong></p>

  <div>
    <div class="character">üê±</div>
    <div>Player 1 HP: <span id="p1HP">100</span></div>
  </div>

  <div style="margin: 1rem 0;"></div>

  <div>
    <div class="character">üê∂</div>
    <div>Player 2 HP: <span id="p2HP">100</span></div>
  </div>

  <button id="attackBtn" disabled>‡πÇ‡∏à‡∏°‡∏ï‡∏µ!</button>

  <div id="log"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

  <script>
    // üîß ‡∏Å‡∏£‡∏≠‡∏Å config Firebase ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "XXXXXXXXXX",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // üí° ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏´‡πâ‡∏≠‡∏á
    const roomRef = db.ref("rooms/demoRoom");

    // üéÆ ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô Player 1 ‡∏´‡∏£‡∏∑‡∏≠ 2
    let player = "";
    roomRef.once("value", snap => {
      const data = snap.val();
      if (!data || !data.p1) {
        player = "p1";
        roomRef.set({ p1: true, p2: false, turn: "p1", p1HP: 100, p2HP: 100 });
      } else if (!data.p2) {
        player = "p2";
        roomRef.update({ p2: true });
      } else {
        alert("‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß!");
      }
      document.getElementById("playerRole").textContent = player === "p1" ? "Player 1 (üê±)" : "Player 2 (üê∂)";
    });

    // üéØ ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏à‡∏°‡∏ï‡∏µ
    const btn = document.getElementById("attackBtn");
    btn.onclick = () => {
      roomRef.once("value", snap => {
        const data = snap.val();
        if (data.turn !== player) return;

        const newHP = (player === "p1" ? data.p2HP : data.p1HP) - 20;
        const update = {
          turn: player === "p1" ? "p2" : "p1",
          [player === "p1" ? "p2HP" : "p1HP"]: newHP < 0 ? 0 : newHP
        };
        roomRef.update(update);
      });
    };

    // üîÑ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
    roomRef.on("value", snap => {
      const data = snap.val();
      if (!data) return;
      document.getElementById("p1HP").textContent = data.p1HP;
      document.getElementById("p2HP").textContent = data.p2HP;
      btn.disabled = (data.turn !== player || data.p1HP <= 0 || data.p2HP <= 0);

      if (data.p1HP <= 0) log("üê∂ Player 2 ‡∏ä‡∏ô‡∏∞!");
      else if (data.p2HP <= 0) log("üê± Player 1 ‡∏ä‡∏ô‡∏∞!");
      else log("‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏Ç‡∏≠‡∏á: " + (data.turn === "p1" ? "üê± Player 1" : "üê∂ Player 2"));
    });

    function log(msg) {
      document.getElementById("log").innerHTML = "<p>" + msg + "</p>";
    }
  </script>
</body>
</html>
